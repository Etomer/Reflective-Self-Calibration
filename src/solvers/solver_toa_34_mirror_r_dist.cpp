#include <Eigen/Dense>
#include "mex.h"




using namespace Eigen;






MatrixXcd solver_toa_34_mirror_r_dist(const VectorXd& data)
{
	// Compute coefficients
    const double* d = data.data();
    VectorXd coeffs(66);
    coeffs[0] = -2*d[0]*d[12] + d[1]*d[12] + d[2]*d[12] + d[0]*d[13] - d[2]*d[13] + d[0]*d[14] - d[1]*d[14];
    coeffs[1] = d[1]*d[12] - d[2]*d[12] + d[0]*d[13] - 2*d[1]*d[13] + d[2]*d[13] - d[0]*d[14] + d[1]*d[14];
    coeffs[2] = -d[1]*d[12] + d[2]*d[12] - d[0]*d[13] + d[2]*d[13] + d[0]*d[14] + d[1]*d[14] - 2*d[2]*d[14];
    coeffs[3] = -2*d[3]*d[12] + d[4]*d[12] + d[5]*d[12] + d[3]*d[13] - d[5]*d[13] + d[3]*d[14] - d[4]*d[14];
    coeffs[4] = d[4]*d[12] - d[5]*d[12] + d[3]*d[13] - 2*d[4]*d[13] + d[5]*d[13] - d[3]*d[14] + d[4]*d[14];
    coeffs[5] = -d[4]*d[12] + d[5]*d[12] - d[3]*d[13] + d[5]*d[13] + d[3]*d[14] + d[4]*d[14] - 2*d[5]*d[14];
    coeffs[6] = -2*d[6]*d[12] + d[7]*d[12] + d[8]*d[12] + d[6]*d[13] - d[8]*d[13] + d[6]*d[14] - d[7]*d[14];
    coeffs[7] = d[7]*d[12] - d[8]*d[12] + d[6]*d[13] - 2*d[7]*d[13] + d[8]*d[13] - d[6]*d[14] + d[7]*d[14];
    coeffs[8] = -d[7]*d[12] + d[8]*d[12] - d[6]*d[13] + d[8]*d[13] + d[6]*d[14] + d[7]*d[14] - 2*d[8]*d[14];
    coeffs[9] = -2*d[9]*d[12] + d[10]*d[12] + d[11]*d[12] + d[9]*d[13] - d[11]*d[13] + d[9]*d[14] - d[10]*d[14];
    coeffs[10] = d[10]*d[12] - d[11]*d[12] + d[9]*d[13] - 2*d[10]*d[13] + d[11]*d[13] - d[9]*d[14] + d[10]*d[14];
    coeffs[11] = -d[10]*d[12] + d[11]*d[12] - d[9]*d[13] + d[11]*d[13] + d[9]*d[14] + d[10]*d[14] - 2*d[11]*d[14];
    coeffs[12] = d[0]*d[0] - d[0]*d[1] - d[0]*d[2] + d[1]*d[2];
    coeffs[13] = -d[0]*d[1] + d[1]*d[1] + d[0]*d[2] - d[1]*d[2];
    coeffs[14] = d[0]*d[1] - d[0]*d[2] - d[1]*d[2] + d[2]*d[2];
    coeffs[15] = d[3]*d[3] - d[3]*d[4] - d[3]*d[5] + d[4]*d[5];
    coeffs[16] = -d[3]*d[4] + d[4]*d[4] + d[3]*d[5] - d[4]*d[5];
    coeffs[17] = d[3]*d[4] - d[3]*d[5] - d[4]*d[5] + d[5]*d[5];
    coeffs[18] = d[6]*d[6] - d[6]*d[7] - d[6]*d[8] + d[7]*d[8];
    coeffs[19] = -d[6]*d[7] + d[7]*d[7] + d[6]*d[8] - d[7]*d[8];
    coeffs[20] = d[6]*d[7] - d[6]*d[8] - d[7]*d[8] + d[8]*d[8];
    coeffs[21] = d[9]*d[9] - d[9]*d[10] - d[9]*d[11] + d[10]*d[11];
    coeffs[22] = -d[9]*d[10] + d[10]*d[10] + d[9]*d[11] - d[10]*d[11];
    coeffs[23] = d[9]*d[10] - d[9]*d[11] - d[10]*d[11] + d[11]*d[11];
    coeffs[24] = d[12]*d[12] - d[12]*d[13] - d[12]*d[14] + d[13]*d[14];
    coeffs[25] = -d[12]*d[13] + d[13]*d[13] + d[12]*d[14] - d[13]*d[14];
    coeffs[26] = d[12]*d[13] - d[12]*d[14] - d[13]*d[14] + d[14]*d[14];
    coeffs[27] = -d[0] - d[1];
    coeffs[28] = -d[0] - d[2];
    coeffs[29] = -d[1] - d[2];
    coeffs[30] = -d[3] - d[4];
    coeffs[31] = -d[3] - d[5];
    coeffs[32] = -d[4] - d[5];
    coeffs[33] = -d[6] - d[7];
    coeffs[34] = -d[6] - d[8];
    coeffs[35] = -d[7] - d[8];
    coeffs[36] = -d[9] - d[10];
    coeffs[37] = -d[9] - d[11];
    coeffs[38] = -d[10] - d[11];
    coeffs[39] = d[12] + d[13];
    coeffs[40] = d[12] + d[14];
    coeffs[41] = d[13] + d[14];
    coeffs[42] = d[0];
    coeffs[43] = d[1];
    coeffs[44] = d[2];
    coeffs[45] = d[3];
    coeffs[46] = d[4];
    coeffs[47] = d[5];
    coeffs[48] = d[6];
    coeffs[49] = d[7];
    coeffs[50] = d[8];
    coeffs[51] = d[9];
    coeffs[52] = d[10];
    coeffs[53] = d[11];
    coeffs[54] = -d[12];
    coeffs[55] = -d[13];
    coeffs[56] = -d[14];
    coeffs[57] = 2*d[15];
    coeffs[58] = -d[15];
    coeffs[59] = 2*d[16];
    coeffs[60] = -d[16];
    coeffs[61] = 2*d[17];
    coeffs[62] = -d[17];
    coeffs[63] = 2*d[18];
    coeffs[64] = -d[18];
    coeffs[65] = 1;



	// Setup elimination template
	static const int coeffs0_ind[] = { 65,65,65,65,65,65,65,65,65,65,65,65,65,65,65,65,65,65,65,40,39,54,65,40,39,54,54,65,65,40,39,54,65,39,41,40,55,39,65,41,40,40,55,39,39,65,65,41,55,65,39,40,55,56,41,40,39,65,56,41,40,39,39,40,65,65,56,41,39,65,40,41,26,25,24,41,40,39,65,26,25,24,24,41,40,40,39,39,41,65,65,65,26,25,39,40,24,41,25,65,65,65,65,65,65,65,65,65,65,65,65,65,65,65,65,65,65,65,51,54,48,54,45,54,36,51,39,54,33,48,45,39,54,54,30,42,39,54,52,36,55,39,49,33,30,55,39,39,46,27,55,39,51,54,48,54,45,54,54,42,37,36,51,40,39,54,34,33,65,48,45,40,39,54,54,65,31,65,30,42,39,40,54,65,39,27,38,37,52,36,41,40,55,39,35,34,31,49,65,33,30,41,40,40,55,39,39,65,65,32,46,27,28,55,41,65,39,40,55,43,38,52,41,55,35,32,49,46,41,41,55,55,43,29,55,41,37,51,40,54,34,48,45,40,54,54,31,42,40,54,40,28,53,38,37,36,56,41,40,39,50,35,34,33,65,30,31,56,41,40,39,39,40,47,65,65,32,27,28,41,56,65,39,40,41,29,53,38,52,56,41,55,50,47,35,49,46,32,56,56,41,55,55,41,43,29,44,55,41,56,53,37,56,40,50,34,31,56,40,40,47,28,56,40,56,44,51,54,48,45,54,54,42,54,9,36,51,24,6,39,54,33,48,45,30,24,39,54,54,3,39,42,27,24,54,39,10,9,52,36,25,24,7,6,3,55,39,49,33,30,46,25,24,24,55,39,39,4,55,27,0,43,25,39,24,55,9,37,51,24,6,40,54,34,48,45,31,24,40,54,54,40,3,42,28,24,54,40,24,0,11,10,9,38,37,36,26,25,24,8,7,41,40,6,39,3,35,34,31,33,65,30,32,26,25,24,24,41,40,40,5,39,39,41,4,65,27,65,28,0,65,29,25,26,39,40,24,41,25,1,11,10,38,52,26,25,8,5,41,7,55,4,35,32,49,46,26,26,25,25,41,41,55,55,43,29,1,2,55,41,25,26,11,9,53,37,26,24,8,56,6,40,3,50,34,31,47,26,24,24,56,40,40,56,5,0,28,44,26,40,24,56,26,2,9,51,24,6,54,3,48,45,42,24,24,54,54,54,0,24,10,9,36,25,24,7,6,3,39,4,33,30,27,25,24,24,25,39,39,0,39,1,24,25,11,9,37,26,24,8,6,40,3,5,34,31,28,26,24,24,26,40,0,40,40,2,24,26,65,65,65,65,65,65,65,65,65,65,65,65,65,65,65,65,65,65,65,64,51,62,54,48,60,54,45,54,63,64,36,51,61,62,60,39,54,33,48,45,59,58,39,54,54,30,39,54,42,64,63,52,36,62,61,59,55,39,49,33,30,60,57,55,39,39,46,55,39,27,64,51,62,54,48,60,54,54,45,54,42,58,63,63,64,37,36,51,61,61,62,60,40,39,54,34,33,48,65,45,59,59,58,40,54,39,65,54,65,39,30,31,40,54,42,65,39,27,57,63,63,64,63,38,37,52,36,61,61,59,62,61,59,41,40,55,39,35,34,31,49,33,65,30,59,60,57,57,41,40,39,55,65,40,65,39,55,46,32,41,65,39,27,40,28,55,43,58,63,64,38,52,61,59,62,60,41,55,35,32,49,46,58,57,41,55,41,55,55,43,41,29,63,64,37,51,61,62,60,40,54,34,48,45,59,58,40,54,54,40,31,54,42,40,28,57,64,63,63,63,53,38,37,36,62,61,61,61,59,59,56,41,40,39,50,35,34,33,65,30,31,60,59,57,57,56,40,41,39,65,39,40,41,32,47,56,65,39,27,65,40,28,41,29,57,64,63,64,53,38,52,62,60,61,62,60,59,56,41,55,50,47,35,49,46,32,58,57,58,56,41,56,55,55,41,55,43,41,29,56,44,64,63,53,37,62,61,59,56,40,50,34,31,60,57,56,40,40,56,47,40,28,56,44,58,64,51,62,60,54,48,45,58,54,54,54,42,21,63,64,9,18,36,51,61,62,60,59,24,6,54,39,33,48,45,15,30,58,57,24,39,54,54,39,3,24,54,42,39,27,22,21,64,63,10,9,19,18,15,52,36,62,61,59,60,25,24,7,6,3,39,55,49,33,30,16,46,57,12,58,25,24,55,39,24,39,55,4,25,39,27,24,0,55,43,22,64,10,19,16,52,62,60,25,7,4,55,49,46,58,13,25,55,25,55,55,43,25,1,21,63,64,9,18,37,51,61,62,60,59,24,6,40,54,34,48,45,31,15,58,57,24,40,54,40,24,3,54,42,54,40,28,24,0,12,23,22,63,64,11,10,20,17,38,19,52,16,61,59,62,60,26,25,8,5,7,41,55,4,35,32,49,46,58,57,13,14,26,25,41,26,55,41,25,55,43,41,29,55,25,1,26,2,23,21,64,63,11,9,20,53,18,37,15,62,61,59,60,26,24,8,56,6,40,3,50,34,31,47,17,12,57,58,26,56,24,40,24,56,26,5,40,28,24,0,40,56,44,26,2,14,23,22,64,63,11,10,53,20,19,38,16,17,62,60,61,59,26,25,8,56,7,41,4,5,50,47,35,32,13,57,58,14,26,56,25,41,25,56,26,41,29,25,1,56,44,41,26,2,23,64,11,20,53,17,62,60,26,8,56,5,50,47,14,58,26,56,26,56,44,26,2,56,21,64,9,18,48,15,62,60,58,24,6,3,54,45,51,42,12,24,54,54,24,54,24,0,22,21,63,10,9,19,18,15,33,16,61,59,57,24,25,7,6,3,4,39,30,36,12,27,13,25,24,39,24,39,25,39,24,0,25,1,22,64,10,19,16,49,62,60,58,25,7,4,55,46,52,13,43,25,55,25,55,55,25,1,23,21,63,11,9,20,18,34,15,17,61,59,57,26,24,8,6,3,5,40,31,12,37,28,14,26,24,40,40,26,40,24,0,24,26,2,23,22,63,11,10,20,17,19,35,16,61,59,57,26,25,8,5,7,4,41,32,13,38,14,29,26,25,41,26,41,41,25,1,26,2,25,23,64,11,20,50,17,62,60,58,26,8,5,56,47,14,53,44,26,56,56,56,26,2,26,21,6,18,15,12,24,3,9,0,24,24,24,22,7,19,16,13,25,4,10,1,25,25,25,23,8,20,17,14,26,5,11,2,26,26,26,65,65,65,64,51,62,54,48,60,54,54,45,63,64,36,48,61,62,60,39,33,54,51,45,59,39,54,54,39,30,54,42,58,64,63,52,33,62,61,59,55,49,39,36,30,60,55,39,39,55,46,39,27,57,64,51,62,54,48,45,60,54,54,54,42,58,63,64,35,49,61,59,62,60,41,38,52,55,32,46,41,55,41,55,55,43,58,41,29,57,63,64,37,48,61,62,60,40,54,34,51,45,31,59,54,40,40,54,54,42,58,40,28,57,64,63,64,50,35,49,62,60,61,62,60,59,56,53,38,55,41,47,52,46,32,56,55,41,56,41,55,55,43,58,41,29,57,56,44,58,64,63,53,34,62,61,59,56,40,50,37,31,47,60,40,56,56,40,40,28,57,56,44,58,64,51,62,60,54,48,45,54,54,54,42,58,21,63,64,9,18,48,36,61,62,60,59,24,6,39,33,51,54,45,30,15,24,39,39,24,3,54,42,58,54,39,27,57,54,22,21,64,63,10,6,19,18,15,33,52,62,61,59,60,25,7,24,9,55,49,36,3,39,30,46,16,25,24,55,24,55,25,4,39,27,57,39,24,0,12,55,43,58,39,22,64,7,19,16,49,62,60,25,10,52,4,55,46,25,25,55,43,58,55,25,1,13,55,21,63,64,9,18,37,48,61,62,60,59,24,6,40,34,54,45,31,3,15,40,54,24,40,54,24,54,42,58,51,40,28,57,24,0,12,23,22,63,64,8,7,20,17,19,35,49,16,61,59,62,60,26,11,10,25,38,5,55,46,41,32,4,26,25,26,55,25,55,55,43,58,41,29,57,52,25,1,13,41,26,2,14,41,23,21,64,63,11,6,20,53,18,34,15,62,61,59,60,26,24,8,56,50,40,9,31,3,47,5,17,24,56,40,26,56,40,26,40,28,57,24,24,0,12,37,56,44,58,26,2,14,23,22,64,63,8,7,20,50,19,35,16,17,62,60,61,59,11,25,26,53,41,10,32,4,56,47,5,25,26,41,26,41,41,29,57,25,25,1,13,56,44,58,38,26,2,14,56,56,23,64,8,20,50,17,62,60,26,56,11,47,5,26,56,56,56,44,58,26,26,2,14,53,21,62,9,18,15,48,60,64,58,24,6,54,45,51,3,24,24,54,54,54,42,24,0,12,22,21,61,6,10,19,18,15,16,33,59,63,57,25,7,9,24,39,30,3,36,4,25,25,39,39,39,27,24,0,12,24,25,1,13,24,22,62,7,19,16,49,60,64,58,10,25,55,46,4,52,55,55,55,43,25,1,13,25,25,23,21,61,11,6,20,18,15,17,34,59,63,57,26,8,24,3,40,31,37,5,26,24,26,40,40,24,40,28,24,0,12,9,26,2,14,23,22,61,8,7,20,17,19,16,35,59,63,57,11,25,4,26,41,32,5,38,25,41,41,25,41,29,25,1,13,26,2,14,10,26,26,23,62,8,20,17,50,60,64,58,26,5,56,47,53,26,56,56,26,56,44,26,2,14,11,18,6,15,21,12,24,3,9,24,24,24,0,19,7,16,22,13,25,4,10,25,25,25,1,20,8,17,23,14,26,5,11,26,26,26,2,65,65,65,65,64,51,62,54,48,45,60,54,54,54,63,62,36,61,48,64,60,39,33,51,54,45,30,59,39,54,39,54,54,42,58,39,64,61,52,62,33,63,59,55,49,36,39,30,46,60,55,39,55,39,39,27,57,55,64,48,62,60,54,51,45,54,54,54,42,58,61,62,35,63,64,49,59,60,38,41,55,46,32,52,41,55,41,55,55,43,58,41,29,57,63,62,34,51,61,64,60,59,40,54,45,37,31,40,54,40,54,48,42,58,54,40,28,57,62,61,62,50,64,63,52,35,60,64,60,59,53,56,41,55,46,32,47,38,56,41,55,55,56,41,49,43,58,55,41,29,57,56,44,58,64,61,50,37,62,63,59,60,56,40,31,53,47,56,40,56,40,34,28,57,40,56,44,58,64,51,62,60,48,54,45,54,54,54,42,58,21,62,63,9,18,36,61,64,45,60,59,24,6,33,54,39,30,3,15,24,24,54,39,39,42,58,54,51,54,39,27,57,48,24,22,18,61,64,10,19,6,21,52,62,63,15,30,59,60,25,7,9,24,49,39,3,55,46,4,16,25,24,25,39,55,24,55,27,57,39,36,24,0,12,39,55,43,58,33,25,19,62,7,22,64,16,46,60,10,25,55,4,25,55,25,43,58,55,52,25,1,13,55,49,21,63,62,6,18,37,61,51,60,59,15,24,34,40,45,54,9,31,48,3,24,24,42,54,40,58,40,54,54,64,40,28,57,24,0,12,20,19,61,62,8,23,22,7,63,17,52,60,32,59,16,11,26,25,4,41,5,46,10,55,49,26,25,41,43,55,58,26,25,55,55,29,57,41,64,25,1,13,38,26,2,14,41,35,23,18,64,61,8,9,20,53,62,37,21,59,15,60,17,26,24,3,50,56,31,40,11,47,34,5,26,24,26,24,28,40,56,57,56,6,0,40,12,40,24,63,56,44,58,26,2,14,20,19,62,61,23,10,8,64,38,22,59,16,47,60,17,26,25,4,5,56,32,11,41,35,26,25,25,56,29,41,57,26,7,1,41,13,41,25,44,58,56,63,26,2,14,53,56,50,20,62,11,53,23,60,17,26,5,47,56,50,26,26,44,56,58,8,2,56,14,56,26,64,21,62,9,18,51,60,64,15,6,24,3,45,48,54,42,58,24,54,54,24,54,24,0,12,18,22,61,10,19,21,3,36,59,15,63,16,7,24,25,4,30,33,39,27,57,24,25,39,39,25,39,0,12,24,9,24,25,1,13,6,19,62,22,4,52,60,16,64,25,46,49,55,43,58,25,55,55,55,1,13,25,10,25,7,23,18,61,11,20,9,15,37,59,63,17,8,26,3,24,5,31,34,6,40,28,57,0,24,26,12,40,40,26,40,24,24,21,26,2,14,20,19,61,23,10,16,5,38,59,17,63,26,4,25,32,35,7,41,29,57,26,1,25,13,41,41,41,25,25,2,14,26,22,11,26,8,20,62,11,17,53,60,64,5,26,47,50,8,56,44,58,2,26,14,56,56,56,26,26,23,18,9,15,21,3,6,24,0,12,24,24,24,19,10,16,22,4,7,25,1,13,25,25,25,20,11,17,23,5,8,26,2,14,26,26,26,64,51,62,60,48,45,42,63,62,36,61,64,48,60,59,33,45,30,51,42,58,27,64,61,52,62,63,33,59,60,49,30,46,36,27,57,43,62,48,64,60,51,45,42,58,61,62,63,35,49,60,59,64,32,52,38,46,43,58,29,57,61,64,34,48,60,63,59,37,51,31,45,62,58,42,28,57,62,64,61,64,50,35,49,60,59,60,63,47,38,52,46,53,32,62,58,43,29,57,44,58,62,63,50,34,59,64,60,53,37,47,31,61,57,28,44,58,64,62,45,60,54,48,51,54,54,54,42,58,21,63,60,9,18,61,45,30,59,15,6,3,39,54,51,33,36,39,54,54,58,39,54,42,64,48,39,27,57,62,0,22,18,64,59,10,19,21,6,62,30,15,46,60,16,7,3,4,55,39,36,49,9,52,55,39,39,57,55,39,27,63,0,12,33,55,43,58,61,1,19,60,22,7,46,16,4,55,52,10,55,55,58,55,43,64,1,13,49,62,18,63,64,6,61,31,60,45,21,59,62,15,9,3,40,58,54,51,34,37,42,48,40,40,54,54,54,40,28,57,0,12,20,19,64,59,23,8,7,16,32,17,60,22,46,62,5,10,41,38,58,55,52,11,4,43,49,41,41,57,55,55,55,41,29,1,13,63,2,14,35,61,20,21,64,63,8,6,15,62,47,59,31,23,60,61,17,11,9,5,3,56,57,40,37,50,53,18,12,28,34,0,56,56,40,40,40,56,44,58,2,14,22,20,63,60,8,7,16,17,47,59,23,32,61,11,10,4,56,53,57,41,38,5,19,13,29,35,1,56,56,58,41,41,41,56,44,2,14,64,50,62,23,64,8,17,60,47,62,11,5,58,56,53,20,14,44,50,2,56,56,56,21,64,18,3,15,60,62,45,58,24,6,54,48,51,9,42,24,24,54,54,54,24,0,12,22,15,63,19,3,4,16,59,61,30,57,25,24,9,7,39,33,36,10,27,25,24,24,12,25,24,0,39,39,39,21,6,25,1,13,18,16,64,4,60,62,46,58,25,10,55,49,52,43,25,25,13,25,1,55,55,55,22,7,19,23,21,63,20,5,15,3,17,59,61,18,31,57,26,12,24,9,8,40,34,37,11,28,0,6,26,26,24,24,24,40,40,40,26,2,14,22,17,63,5,16,4,59,61,19,32,57,26,11,13,25,10,41,35,38,29,1,7,26,26,14,25,25,25,26,2,41,41,41,23,8,20,23,64,17,5,60,62,20,47,58,14,26,11,56,50,53,44,2,8,26,26,26,56,56,56,21,15,18,3,12,24,6,9,0,24,24,24,22,16,19,4,13,25,7,10,1,25,25,25,23,17,20,5,14,26,8,11,2,26,26,26,64,62,60,58,63,62,61,60,59,64,58,57,62,64,60,58,63,61,62,61,59,63,64,59,60,58,57,57,61,62,63,64,59,60,58,57,60,45,62,64,48,51,42,58,21,60,59,18,15,30,51,64,61,63,33,48,45,36,42,58,62,27,57,12,22,18,59,60,19,15,16,46,36,63,62,21,64,49,33,30,52,27,57,12,61,43,58,13,19,60,16,52,64,22,49,46,43,58,13,62,18,59,60,21,15,31,51,64,61,63,58,62,34,37,45,42,48,28,57,12,20,19,59,60,17,22,38,63,52,64,23,16,58,62,35,32,46,43,49,29,57,13,14,61,20,18,60,59,23,21,17,15,47,37,63,62,64,57,61,12,50,53,31,28,34,44,58,14,20,19,60,59,23,22,16,53,64,38,63,17,57,61,13,50,47,32,29,35,44,58,14,62,20,60,23,17,53,64,58,62,14,47,44,50,15,60,3,18,51,62,64,21,58,6,9,48,42,45,0,12,15,16,59,4,9,21,19,36,61,63,22,57,7,6,3,10,0,12,33,27,30,18,1,13,16,60,10,22,52,62,64,58,7,4,1,13,49,43,46,19,17,15,59,5,9,21,20,37,61,63,23,57,12,18,8,11,3,0,6,34,28,31,2,14,17,16,59,11,23,10,22,38,61,63,57,13,19,8,5,4,1,7,2,14,35,29,32,20,17,60,11,23,53,62,64,58,14,20,5,2,8,50,44,47,15,9,18,21,12,6,0,3,16,10,19,22,13,7,1,4,17,11,20,23,14,8,2,5,60,62,64,58,59,64,61,62,60,63,58,57,59,64,61,63,60,58,62,57,15,64,18,21,62,58,60,12,16,21,63,19,18,15,22,12,61,57,59,13,22,64,19,16,13,62,58,60,17,21,63,20,23,15,12,18,61,57,59,14,23,22,63,20,17,16,13,19,14,61,57,59,23,64,17,14,20,62,58,60,21,18,12,15,22,19,13,16,23,20,14,17,65,65,65,65,63,63,64,37,36,48,61,61,62,60,40,34,39,51,54,33,65,45,30,59,59,40,54,65,54,39,65,39,40,31,54,42,58,65,39,27,57,65,65,65,65,65,65,65,65,63,63,64,63,38,34,52,33,61,61,59,62,61,59,41,35,40,37,55,36,39,49,31,65,30,46,60,59,41,40,39,40,39,55,55,41,32,65,39,27,57,65,40,28,57,65,55,43,58,65,65,65,65,64,63,63,63,53,38,34,33,62,61,61,61,59,59,56,50,41,37,39,40,35,65,36,30,31,32,59,60,56,39,40,65,40,41,65,41,56,47,65,39,39,27,57,40,28,57,41,29,57,23,22,21,63,63,63,11,10,9,20,19,38,37,18,36,15,61,61,59,61,59,59,26,25,24,8,7,6,40,41,39,3,35,34,31,17,33,30,32,16,65,57,57,12,57,26,24,25,41,40,39,65,40,65,24,41,25,4,5,26,65,39,27,40,28,39,24,0,41,29,25,1,13 };
	static const int coeffs1_ind[] = { 23,19,18,59,59,59,20,17,22,21,16,32,37,63,36,63,61,15,63,57,61,35,34,31,38,30,27,33,28,57,12,61,29,57,13,14,63,61,62,37,61,33,48,60,64,63,59,59,34,31,36,51,30,65,45,65,65,42,58,65,27,57,28,65,65,65,65,63,63,62,37,61,33,64,48,61,60,59,40,34,39,54,45,65,51,36,30,31,59,40,40,39,54,39,65,54,65,54,42,58,65,39,27,57,40,63,61,62,61,38,61,63,34,49,33,59,59,63,64,60,59,35,31,32,52,36,46,65,37,30,65,65,65,27,57,28,57,43,58,29,65,65,65,65,65,65,65,65,63,61,64,61,38,61,34,63,49,63,33,62,59,59,60,41,35,37,40,55,39,30,65,31,36,52,46,32,59,41,40,41,55,39,55,65,40,39,65,39,27,57,40,28,57,65,55,43,58,41,64,61,63,61,53,62,35,34,33,59,59,63,63,59,60,50,47,38,37,36,32,30,65,31,61,57,27,65,65,65,28,57,29,57,44,65,65,65,65,64,63,61,61,53,62,35,63,36,34,61,63,59,59,59,56,50,41,40,39,30,31,37,65,38,32,47,60,56,56,41,40,39,41,39,65,40,33,27,65,57,65,39,40,28,57,41,29,57,56,23,19,18,63,63,59,11,20,7,6,15,61,31,32,59,21,30,22,59,61,16,17,8,5,10,9,4,41,40,37,57,39,36,35,65,3,38,27,33,41,40,40,57,41,39,39,39,40,28,65,0,65,12,65,63,34,41,29,57,61,1,13,2,23,22,18,61,63,61,11,20,7,21,6,19,38,61,63,36,59,31,59,15,59,16,26,8,25,24,3,35,40,41,30,9,39,10,32,33,65,4,5,17,26,26,25,24,25,40,27,39,41,57,65,65,24,41,65,39,39,28,57,40,63,24,0,12,37,40,41,29,57,34,25,1,13,26,23,22,21,63,63,63,11,10,6,20,19,18,34,38,33,15,61,61,59,61,59,59,26,8,25,9,24,7,41,35,37,39,30,40,65,31,3,32,4,16,17,26,24,41,39,24,25,41,65,65,39,25,26,5,65,39,27,57,40,28,57,36,24,0,12,40,41,29,57,40,25,1,13 };

	static const int C0_ind[] = { 0,14,54,193,207,208,259,386,401,442,574,579,596,600,641,772,789,791,827,960,962,963,965,974,977,980,984,985,991,1014,1018,1025,1028,1150,1152,1153,1154,1155,1158,1166,1167,1168,1169,1172,1176,1178,1179,1206,1210,1216,1217,1219,1342,1344,1346,1347,1348,1351,1358,1361,1364,1365,1367,1368,1372,1374,1398,1402,1403,1406,1409,1534,1536,1538,1539,1541,1542,1543,1544,1550,1553,1556,1560,1561,1562,1563,1564,1566,1567,1568,1569,1570,1590,1594,1598,1600,1601,1604,1726,1737,1768,1823,1930,1961,1962,2098,2123,2155,2206,2301,2316,2348,2354,2477,2509,2543,2545,2649,2688,2697,2702,2728,2742,2783,2880,2881,2889,2890,2894,2895,2896,2920,2921,2922,2934,2947,2975,3058,3072,3073,3081,3082,3086,3087,3088,3112,3113,3114,3126,3139,3167,3250,3266,3275,3281,3307,3322,3358,3453,3454,3456,3458,3459,3465,3467,3468,3470,3473,3474,3476,3480,3496,3499,3500,3506,3507,3510,3513,3514,3521,3550,3551,3629,3640,3645,3646,3648,3649,3650,3651,3657,3658,3659,3660,3662,3663,3664,3665,3667,3668,3672,3688,3689,3690,3691,3692,3698,3700,3701,3702,3706,3713,3715,3742,3743,3810,3821,3826,3837,3838,3841,3843,3850,3852,3855,3856,3860,3864,3881,3882,3884,3890,3905,3907,4013,4018,4034,4036,4043,4045,4049,4053,4055,4075,4079,4081,4090,4091,4126,4185,4221,4222,4224,4226,4227,4228,4233,4235,4236,4237,4238,4241,4244,4245,4246,4247,4248,4264,4267,4268,4271,4273,4274,4278,4279,4280,4282,4283,4289,4318,4319,4363,4377,4397,4413,4414,4417,4419,4420,4426,4428,4429,4431,4432,4436,4437,4439,4440,4457,4458,4460,4463,4465,4466,4475,4481,4483,4569,4589,4594,4610,4612,4619,4621,4625,4629,4631,4651,4655,4657,4666,4667,4702,4761,4797,4798,4805,4818,4825,4831,4851,4857,4868,4984,4992,4997,4998,5001,5006,5010,5011,5017,5018,5019,5023,5032,5043,5044,5045,5046,5049,5056,5060,5087,5154,5176,5184,5185,5189,5190,5193,5194,5198,5199,5200,5202,5203,5209,5210,5211,5215,5224,5225,5226,5235,5236,5237,5238,5241,5248,5251,5252,5279,5346,5362,5368,5378,5381,5383,5387,5393,5394,5398,5401,5404,5406,5407,5419,5427,5431,5432,5433,5434,5438,5444,5470,5515,5560,5565,5566,5568,5570,5571,5573,5574,5575,5577,5579,5580,5582,5585,5586,5587,5588,5590,5592,5593,5594,5595,5596,5597,5598,5599,5608,5611,5612,5618,5619,5620,5621,5622,5623,5624,5625,5626,5629,5630,5631,5632,5633,5634,5636,5662,5663,5707,5730,5741,5752,5757,5758,5761,5763,5766,5767,5770,5772,5775,5776,5779,5780,5782,5784,5786,5787,5788,5790,5801,5802,5804,5810,5812,5813,5815,5816,5822,5824,5825,5827,5899,5922,5933,5938,5954,5956,5957,5959,5963,5965,5969,5970,5973,5974,5975,5977,5980,5982,5983,5995,5999,6001,6003,6007,6008,6009,6010,6011,6014,6020,6046,6091,6105,6136,6141,6142,6149,6152,6162,6169,6173,6175,6176,6177,6178,6195,6201,6205,6207,6210,6212,6328,6341,6342,6344,6354,6355,6361,6362,6363,6365,6367,6368,6369,6370,6387,6388,6389,6393,6397,6399,6400,6402,6404,6498,6520,6533,6535,6536,6546,6550,6553,6556,6557,6558,6559,6560,6561,6562,6579,6583,6584,6585,6589,6590,6591,6594,6596,6667,6712,6755,6790,6840,6948,6984,6993,7089,7141,7181,7197,7292,7334,7370,7387,7467,7527,7571,7573,7638,7680,7689,7694,7715,7720,7734,7750,7775,7800,7872,7873,7881,7882,7886,7887,7888,7907,7908,7912,7913,7914,7926,7939,7942,7944,7953,7967,7992,8049,8050,8064,8065,8073,8074,8078,8079,8080,8099,8100,8104,8105,8106,8118,8131,8134,8136,8145,8159,8184,8241,8242,8258,8267,8273,8293,8299,8314,8333,8349,8350,8444,8445,8446,8448,8450,8451,8457,8459,8460,8462,8465,8468,8472,8483,8485,8486,8488,8491,8492,8494,8498,8502,8506,8513,8518,8522,8525,8527,8539,8540,8541,8542,8543,8568,8619,8621,8631,8636,8637,8638,8640,8641,8642,8643,8649,8650,8651,8652,8654,8655,8656,8657,8660,8664,8675,8676,8677,8678,8680,8681,8682,8683,8684,8685,8690,8694,8698,8705,8707,8710,8712,8714,8717,8720,8721,8729,8731,8733,8734,8735,8760,8801,8811,8813,8817,8818,8828,8829,8830,8833,8835,8842,8844,8847,8848,8852,8856,8868,8870,8873,8874,8876,8882,8897,8899,8904,8906,8913,8923,9003,9005,9009,9010,9026,9028,9035,9037,9041,9045,9047,9061,9063,9067,9071,9073,9082,9083,9101,9107,9109,9117,9118,9174,9177,9212,9213,9214,9216,9218,9219,9220,9225,9227,9228,9229,9230,9233,9236,9237,9239,9240,9251,9253,9254,9255,9256,9259,9260,9263,9264,9265,9266,9270,9274,9275,9281,9286,9290,9293,9299,9300,9301,9307,9309,9310,9311,9336,9354,9366,9369,9383,9387,9389,9404,9405,9406,9409,9411,9412,9418,9420,9421,9423,9424,9428,9429,9431,9432,9444,9446,9447,9449,9450,9452,9455,9457,9458,9467,9473,9475,9480,9482,9489,9491,9493,9499,9558,9561,9579,9581,9585,9586,9602,9604,9611,9613,9617,9621,9623,9637,9639,9643,9647,9649,9658,9659,9677,9683,9685,9693,9694,9750,9753,9788,9789,9790,9797,9810,9817,9823,9838,9843,9849,9860,9871,9884,9975,9976,9984,9989,9990,9993,9998,10002,10003,10009,10010,10011,10015,10019,10024,10029,10030,10035,10036,10037,10038,10041,10048,10052,10054,10063,10064,10073,10076,10079,10104,10145,10146,10167,10168,10176,10177,10181,10182,10185,10186,10190,10191,10192,10194,10195,10201,10202,10203,10207,10211,10212,10216,10217,10218,10221,10222,10227,10228,10229,10230,10233,10240,10243,10244,10246,10248,10255,10256,10257,10265,10268,10271,10296,10337,10338,10353,10354,10359,10360,10369,10374,10378,10383,10384,10387,10394,10395,10404,10409,10410,10413,10420,10421,10432,10435,10440,10448,10449,10457,10529,10530,10545,10546,10562,10565,10567,10571,10577,10578,10582,10585,10588,10590,10591,10597,10603,10606,10608,10611,10615,10616,10617,10618,10622,10628,10637,10639,10644,10652,10653,10654,10698,10699,10727,10743,10744,10748,10749,10750,10753,10755,10758,10759,10762,10764,10767,10768,10771,10772,10774,10776,10778,10779,10780,10782,10788,10790,10793,10794,10796,10797,10800,10802,10804,10805,10807,10808,10814,10816,10817,10819,10824,10826,10832,10833,10836,10841,10843,10890,10891,10913,10914,10919,10923,10925,10929,10930,10946,10948,10949,10951,10955,10957,10961,10962,10965,10966,10967,10969,10972,10974,10975,10981,10983,10987,10990,10991,10992,10993,10995,10999,11000,11001,11002,11003,11006,11012,11021,11023,11027,11028,11029,11036,11037,11038,11082,11083,11094,11097,11111,11127,11128,11132,11133,11134,11139,11140,11142,11143,11148,11149,11155,11156,11157,11158,11159,11160,11162,11163,11164,11166,11174,11175,11180,11181,11183,11184,11185,11186,11188,11189,11191,11192,11195,11198,11200,11201,11210,11216,11219,11220,11221,11225,11227,11274,11275,11286,11289,11297,11298,11303,11307,11309,11332,11335,11341,11349,11350,11351,11356,11358,11367,11375,11376,11377,11383,11384,11387,11390,11411,11412,11413,11466,11467,11478,11481,11495,11525,11528,11538,11545,11549,11551,11552,11553,11554,11566,11571,11577,11580,11581,11583,11586,11588,11599,11608,11610,11612,11642,11703,11704,11717,11718,11720,11730,11731,11737,11738,11739,11741,11743,11744,11745,11746,11757,11758,11763,11764,11765,11769,11772,11773,11775,11776,11778,11780,11791,11792,11800,11801,11802,11804,11834,11873,11874,11895,11896,11910,11912,11923,11930,11931,11933,11936,11937,11938,11949,11956,11957,11964,11965,11967,11968,11970,11984,11992,11993,11994,12026,12065,12066,12101,12103,12104,12114,12118,12121,12124,12125,12126,12127,12128,12129,12130,12142,12144,12147,12151,12152,12153,12156,12157,12158,12159,12162,12164,12175,12180,12184,12186,12188,12218,12234,12235,12263,12279,12280,12294,12295,12296,12307,12310,12314,12315,12316,12317,12318,12320,12321,12322,12333,12336,12340,12341,12343,12344,12348,12349,12350,12351,12352,12354,12368,12372,12376,12377,12378,12410,12426,12427,12449,12450,12455,12487,12488,12502,12508,12509,12510,12512,12513,12514,12528,12535,12536,12540,12541,12542,12543,12546,12564,12568,12570,12602,12618,12619,12647,12680,12701,12704,12705,12706,12732,12733,12735,12738,12760,12762,12794,12872,12893,12896,12897,12898,12924,12925,12927,12930,12952,12954,12986,13064,13085,13088,13089,13090,13116,13117,13119,13122,13144,13146,13178,13317,13345,13367,13449,13475,13480,13509,13510,13535,13537,13559,13560,13641,13642,13667,13668,13672,13673,13674,13701,13702,13703,13704,13713,13727,13729,13730,13739,13751,13752,13808,13809,13810,13833,13834,13859,13860,13864,13865,13866,13893,13894,13895,13896,13905,13919,13921,13922,13931,13943,13944,14000,14001,14002,14027,14053,14059,14089,14093,14109,14110,14128,14134,14203,14204,14205,14218,14220,14244,14246,14249,14250,14252,14258,14279,14280,14282,14284,14289,14299,14306,14312,14315,14318,14378,14379,14381,14384,14385,14386,14411,14413,14437,14439,14443,14447,14449,14473,14475,14477,14483,14485,14493,14494,14503,14512,14518,14547,14548,14550,14553,14587,14588,14589,14602,14604,14605,14628,14630,14631,14633,14634,14636,14639,14641,14642,14663,14664,14666,14667,14668,14673,14675,14677,14683,14690,14695,14696,14699,14702,14739,14740,14742,14745,14762,14763,14765,14768,14769,14770,14795,14797,14821,14823,14827,14831,14833,14857,14859,14861,14867,14869,14877,14878,14887,14896,14902,14931,14932,14934,14937,14971,14972,14973,14994,15022,15027,15033,15054,15055,15068,15081,15089,15158,15159,15160,15177,15186,15187,15203,15208,15213,15214,15219,15220,15221,15225,15237,15238,15246,15247,15248,15254,15257,15260,15263,15265,15273,15281,15287,15288,15325,15329,15330,15342,15350,15351,15352,15353,15369,15370,15378,15379,15395,15396,15400,15401,15402,15405,15406,15411,15412,15413,15417,15429,15430,15431,15432,15438,15439,15440,15441,15446,15449,15452,15455,15457,15458,15465,15467,15473,15479,15480,15517,15521,15522,15534,15536,15537,15538,15542,15543,15544,15545,15562,15571,15588,15593,15594,15597,15604,15605,15623,15624,15632,15633,15638,15641,15650,15659,15709,15713,15714,15726,15728,15729,15730,15737,15755,15762,15766,15781,15787,15790,15792,15795,15799,15800,15801,15817,15821,15822,15823,15826,15828,15836,15837,15838,15849,15853,15856,15857,15860,15862,15878,15882,15883,15911,15926,15927,15928,15931,15932,15933,15946,15948,15955,15958,15972,15974,15977,15978,15980,15981,15984,15986,15988,15989,15991,15992,16007,16008,16010,16012,16016,16017,16018,16020,16022,16025,16027,16034,16040,16043,16045,16046,16052,16070,16074,16075,16093,16097,16098,16103,16106,16107,16109,16110,16112,16113,16114,16121,16139,16141,16146,16150,16165,16167,16171,16174,16175,16176,16177,16179,16183,16184,16185,16201,16203,16205,16206,16207,16210,16211,16212,16213,16220,16221,16222,16231,16233,16237,16240,16241,16244,16246,16262,16266,16267,16275,16276,16278,16281,16295,16310,16311,16312,16315,16316,16317,16332,16333,16339,16342,16358,16359,16364,16365,16367,16368,16369,16370,16372,16373,16375,16376,16394,16395,16396,16400,16402,16403,16404,16405,16406,16409,16411,16423,16424,16429,16430,16436,16454,16458,16459,16467,16468,16470,16473,16477,16481,16482,16487,16490,16491,16493,16494,16505,16525,16534,16551,16559,16560,16561,16567,16568,16587,16594,16595,16596,16597,16615,16621,16628,16646,16650,16651,16659,16660,16662,16665,16679,16722,16733,16750,16755,16761,16764,16765,16767,16770,16782,16783,16791,16792,16794,16796,16809,16817,16818,16819,16825,16826,16886,16887,16888,16914,16915,16925,16941,16942,16947,16948,16949,16953,16956,16957,16959,16962,16974,16975,16976,16982,16983,16984,16985,16986,16988,17001,17009,17010,17011,17017,17018,17053,17057,17058,17070,17078,17079,17080,17081,17107,17117,17133,17140,17141,17148,17149,17151,17154,17168,17174,17175,17176,17177,17178,17202,17203,17209,17210,17245,17249,17250,17262,17273,17298,17302,17309,17326,17328,17331,17335,17336,17337,17340,17341,17343,17346,17358,17359,17362,17364,17367,17368,17370,17372,17385,17389,17393,17394,17395,17396,17401,17402,17414,17418,17419,17447,17462,17463,17464,17491,17494,17501,17517,17520,17524,17525,17527,17528,17532,17533,17535,17538,17552,17554,17556,17558,17559,17560,17561,17562,17581,17586,17587,17588,17593,17594,17606,17610,17611,17629,17633,17634,17639,17646,17657,17686,17693,17712,17719,17720,17724,17725,17727,17730,17746,17748,17751,17752,17754,17773,17778,17779,17780,17785,17786,17798,17802,17803,17831,17885,17916,17917,17919,17922,17943,17944,17946,17970,17971,17977,17978,18077,18108,18109,18111,18114,18135,18136,18138,18162,18163,18169,18170,18269,18300,18301,18303,18306,18327,18328,18330,18354,18355,18361,18362,18528,18555,18557,18623,18659,18693,18694,18720,18721,18743,18744,18747,18749,18815,18851,18852,18885,18886,18887,18888,18897,18912,18913,18914,18915,18923,18935,18936,18939,18940,18941,18958,18991,18992,18993,19007,19043,19044,19077,19078,19079,19080,19089,19104,19105,19106,19107,19115,19127,19128,19131,19132,19133,19150,19183,19184,19185,19199,19237,19273,19277,19293,19300,19312,19318,19326,19329,19386,19387,19388,19428,19430,19463,19464,19466,19468,19473,19483,19490,19491,19493,19496,19499,19502,19516,19519,19534,19536,19560,19562,19563,19567,19568,19569,19621,19623,19657,19659,19661,19667,19669,19677,19684,19686,19687,19696,19702,19710,19712,19713,19714,19731,19732,19734,19736,19770,19771,19772,19812,19814,19815,19847,19848,19850,19851,19852,19857,19859,19861,19867,19874,19875,19877,19878,19879,19880,19883,19886,19900,19903,19904,19906,19918,19920,19923,19924,19926,19928,19944,19946,19947,19951,19952,19953,20005,20007,20041,20043,20045,20051,20053,20061,20068,20070,20071,20080,20086,20094,20096,20097,20098,20115,20116,20118,20120,20154,20155,20156,20206,20238,20239,20252,20265,20268,20273,20297,20305,20341,20342,20343,20387,20397,20398,20421,20422,20430,20431,20432,20438,20441,20444,20448,20449,20457,20458,20460,20465,20471,20472,20475,20477,20485,20489,20497,20509,20513,20517,20526,20531,20533,20534,20535,20537,20543,20579,20580,20589,20590,20613,20614,20615,20616,20622,20623,20624,20625,20630,20633,20636,20640,20641,20642,20643,20649,20650,20651,20652,20657,20663,20664,20667,20668,20669,20677,20681,20686,20689,20701,20705,20709,20718,20719,20720,20721,20723,20725,20726,20727,20729,20735,20772,20781,20807,20808,20816,20817,20822,20825,20834,20835,20842,20843,20860,20869,20878,20893,20897,20901,20910,20911,20912,20913,20915,20921,20965,20974,20976,21001,21005,21006,21007,21010,21012,21020,21021,21028,21033,21036,21037,21039,21040,21041,21044,21046,21054,21057,21062,21064,21065,21066,21073,21077,21079,21095,21109,21110,21111,21114,21115,21116,21156,21158,21165,21168,21191,21192,21194,21196,21200,21201,21202,21204,21206,21209,21211,21218,21219,21221,21224,21226,21227,21229,21230,21231,21236,21244,21247,21253,21254,21256,21258,21262,21264,21269,21271,21277,21281,21285,21287,21288,21290,21291,21294,21295,21296,21297,21299,21305,21349,21351,21358,21360,21385,21387,21389,21390,21391,21394,21395,21396,21397,21404,21405,21412,21414,21415,21417,21420,21421,21423,21424,21425,21428,21430,21438,21440,21441,21442,21446,21448,21449,21450,21457,21459,21460,21461,21462,21463,21464,21479,21493,21494,21495,21498,21499,21500,21542,21543,21549,21552,21578,21579,21580,21584,21586,21587,21588,21589,21590,21593,21595,21605,21606,21607,21608,21610,21613,21614,21615,21620,21631,21632,21634,21637,21638,21640,21642,21648,21651,21652,21653,21654,21655,21656,21661,21665,21669,21671,21672,21674,21675,21678,21683,21689,21735,21744,21771,21778,21779,21780,21781,21798,21799,21805,21807,21812,21824,21826,21830,21832,21834,21843,21844,21845,21846,21847,21848,21863,21934,21948,21966,21967,21975,21976,21978,21980,21993,21996,22001,22002,22003,22005,22009,22010,22025,22029,22031,22033,22034,22069,22070,22071,22125,22126,22140,22158,22159,22160,22166,22167,22168,22169,22170,22172,22185,22186,22188,22193,22194,22195,22197,22201,22202,22213,22217,22221,22223,22225,22226,22237,22241,22245,22254,22259,22261,22262,22263,22265,22317,22332,22352,22358,22359,22360,22361,22362,22378,22386,22387,22389,22393,22394,22405,22413,22415,22418,22429,22433,22437,22446,22451,22457,22510,22512,22524,22542,22543,22546,22548,22551,22552,22554,22556,22569,22572,22573,22575,22577,22578,22579,22580,22581,22585,22586,22598,22600,22601,22602,22605,22607,22609,22610,22613,22615,22631,22645,22646,22647,22701,22704,22716,22736,22738,22740,22742,22743,22744,22745,22746,22762,22765,22767,22770,22771,22772,22773,22777,22778,22789,22790,22792,22794,22797,22799,22802,22805,22807,22813,22817,22821,22823,22830,22835,22841,22896,22908,22930,22932,22935,22936,22938,22957,22959,22962,22963,22964,22965,22969,22970,22982,22984,22986,22989,22991,22994,22997,22999,23015,23100,23127,23128,23130,23154,23155,23157,23161,23162,23181,23183,23186,23292,23319,23320,23322,23346,23347,23349,23353,23354,23373,23375,23378,23484,23511,23512,23514,23538,23539,23541,23545,23546,23565,23567,23570,23685,23712,23713,23735,23739,23741,23807,23877,23879,23904,23905,23906,23907,23915,23927,23931,23932,23933,23950,23983,23984,23999,24069,24071,24096,24097,24098,24099,24107,24119,24123,24124,24125,24142,24175,24176,24191,24265,24292,24304,24310,24318,24321,24378,24379,24455,24460,24482,24483,24485,24488,24491,24494,24508,24511,24526,24528,24552,24554,24559,24560,24649,24651,24676,24678,24679,24688,24694,24702,24704,24705,24706,24723,24724,24728,24762,24763,24839,24843,24844,24866,24867,24869,24870,24871,24872,24875,24878,24892,24895,24896,24898,24910,24912,24915,24916,24920,24936,24938,24943,24944,25033,25035,25060,25062,25063,25072,25078,25086,25088,25089,25090,25107,25108,25112,25146,25147,25230,25257,25260,25265,25283,25289,25297,25306,25310,25332,25333,25334,25413,25422,25430,25440,25441,25449,25450,25452,25457,25463,25467,25469,25475,25476,25477,25481,25489,25498,25499,25500,25501,25502,25508,25509,25518,25523,25524,25525,25526,25529,25535,25605,25607,25614,25622,25632,25633,25634,25635,25641,25642,25643,25644,25649,25655,25659,25660,25661,25667,25668,25669,25673,25678,25681,25690,25691,25692,25693,25694,25700,25701,25710,25711,25712,25715,25716,25717,25718,25721,25727,25799,25814,25826,25827,25834,25835,25852,25860,25861,25870,25883,25884,25885,25892,25893,25902,25903,25904,25907,25913,25993,25998,26002,26020,26025,26028,26029,26031,26032,26033,26036,26038,26046,26049,26051,26054,26055,26056,26057,26065,26069,26071,26074,26078,26079,26080,26083,26100,26101,26102,26106,26107,26183,26188,26194,26198,26210,26211,26213,26216,26218,26219,26221,26222,26223,26228,26236,26239,26244,26245,26246,26247,26248,26254,26256,26261,26263,26267,26268,26269,26271,26272,26275,26276,26277,26280,26282,26286,26287,26288,26291,26297,26377,26379,26382,26386,26404,26406,26407,26409,26412,26413,26415,26416,26417,26420,26422,26430,26432,26433,26434,26435,26438,26439,26440,26441,26449,26451,26452,26453,26455,26456,26458,26462,26463,26464,26467,26484,26485,26486,26490,26491,26571,26572,26578,26582,26597,26598,26599,26600,26602,26605,26606,26607,26612,26623,26624,26626,26628,26629,26630,26631,26632,26640,26643,26644,26645,26647,26648,26651,26652,26653,26655,26656,26659,26660,26661,26664,26666,26670,26675,26681,26763,26770,26790,26791,26797,26799,26804,26816,26818,26822,26823,26824,26835,26836,26837,26839,26840,26847,26848,26851,26958,26967,26985,26988,26993,26994,26995,26997,27001,27011,27017,27020,27021,27023,27025,27026,27034,27038,27046,27049,27052,27060,27061,27062,27150,27158,27159,27177,27178,27180,27185,27186,27187,27189,27193,27203,27204,27205,27209,27212,27213,27215,27217,27218,27226,27227,27228,27229,27230,27236,27237,27238,27241,27244,27246,27251,27252,27253,27254,27257,27350,27351,27370,27378,27379,27381,27385,27396,27397,27404,27405,27407,27410,27419,27420,27421,27428,27429,27430,27433,27436,27438,27443,27449,27534,27538,27543,27561,27564,27565,27567,27569,27570,27571,27572,27573,27577,27587,27590,27591,27592,27593,27596,27597,27599,27601,27602,27605,27607,27610,27614,27615,27616,27619,27622,27625,27628,27636,27637,27638,27730,27734,27735,27754,27757,27759,27762,27763,27764,27765,27769,27780,27781,27782,27783,27784,27788,27789,27791,27794,27797,27799,27803,27804,27805,27807,27808,27811,27812,27813,27814,27817,27820,27822,27827,27833,27922,27927,27949,27951,27954,27955,27956,27957,27961,27974,27975,27976,27980,27981,27983,27986,27989,27991,27999,28000,28003,28006,28009,28012,28119,28146,28147,28149,28153,28172,28173,28175,28178,28198,28201,28204,28311,28338,28339,28341,28345,28364,28365,28367,28370,28390,28393,28396,28503,28530,28531,28533,28537,28556,28557,28559,28562,28582,28585,28588,28704,28731,28733,28799,28896,28899,28923,28924,28925,28942,28975,28991,29092,29118,29121,29178,29280,29284,29285,29307,29309,29310,29311,29313,29328,29352,29370,29375,29476,29478,29502,29504,29505,29506,29528,29562,29676,29699,29705,29713,29722,29726,29748,29749,29856,29866,29868,29883,29885,29891,29892,29893,29897,29905,29914,29915,29916,29918,29924,29925,29939,29940,29941,29951,30048,30051,30058,30060,30075,30076,30077,30083,30084,30085,30089,30094,30097,30106,30107,30108,30110,30116,30117,30127,30131,30132,30133,30143,30243,30250,30268,30276,30277,30286,30299,30300,30308,30309,30319,30323,30436,30444,30447,30462,30465,30467,30471,30472,30473,30481,30485,30487,30490,30494,30495,30496,30499,30516,30517,30522,30627,30629,30634,30639,30652,30655,30660,30661,30663,30664,30670,30672,30677,30679,30683,30684,30687,30688,30691,30692,30693,30696,30703,30707,30820,30822,30828,30831,30846,30848,30849,30850,30851,30855,30856,30857,30865,30869,30871,30872,30874,30878,30879,30880,30883,30900,30901,30906,31013,31014,31018,31023,31039,31040,31042,31044,31045,31047,31048,31056,31061,31063,31064,31067,31068,31071,31072,31075,31076,31077,31080,31091,31206,31215,31232,31234,31239,31240,31253,31255,31256,31263,31264,31267,31404,31413,31427,31433,31436,31437,31439,31441,31442,31450,31454,31462,31465,31468,31476,31477,31594,31596,31605,31619,31620,31621,31625,31628,31629,31631,31633,31634,31642,31643,31644,31646,31652,31653,31654,31657,31660,31667,31668,31669,31786,31797,31812,31813,31820,31821,31823,31826,31835,31836,31844,31845,31846,31849,31852,31859,31980,31983,31989,32003,32007,32008,32009,32012,32013,32015,32017,32018,32021,32023,32026,32030,32031,32032,32035,32038,32041,32044,32052,32053,32170,32175,32181,32196,32197,32199,32200,32204,32205,32207,32210,32213,32215,32219,32220,32223,32224,32227,32228,32229,32230,32233,32236,32243,32367,32373,32391,32392,32396,32397,32399,32402,32405,32407,32415,32416,32419,32422,32425,32428,32565,32588,32589,32591,32594,32614,32617,32620,32757,32780,32781,32783,32786,32806,32809,32812,32949,32972,32973,32975,32978,32998,33001,33004,33155,33178,33182,33204,33347,33348,33370,33371,33372,33374,33380,33396,33539,33543,33562,33566,33567,33568,33571,33588,33731,33740,33754,33758,33766,33769,33772,33780,33923,33924,33932,33946,33947,33948,33950,33956,33958,33961,33964,33972,34116,34124,34139,34140,34148,34150,34153,34156,34307,34311,34316,34330,34334,34335,34336,34339,34342,34345,34348,34356,34500,34503,34508,34523,34524,34527,34528,34531,34532,34534,34537,34540,34695,34700,34719,34720,34723,34726,34729,34732,34892,34918,34921,34924,35084,35110,35113,35116,35276,35302,35305,35308,35401,35440,35446,35515,35529,35531,35532,35555,35557,35558,35560,35563,35564,35570,35589,35590,35593,35594,35596,35597,35598,35611,35613,35614,35615,35617,35624,35625,35630,35632,35633,35638,35639,35640,35690,35691,35693,35702,35707,35708,35709,35783,35810,35819,35888,35980,36008,36014,36074,36105,36106,36107,36108,36131,36132,36133,36134,36136,36137,36138,36139,36140,36146,36165,36166,36167,36168,36169,36170,36172,36173,36177,36182,36187,36189,36190,36191,36193,36194,36200,36203,36206,36208,36214,36215,36216,36253,36266,36267,36269,36270,36272,36273,36274,36281,36283,36284,36285,36363,36391,36435,36436,36489,36491,36492,36493,36515,36517,36518,36519,36520,36523,36524,36527,36529,36530,36549,36550,36553,36554,36555,36556,36557,36562,36563,36565,36571,36573,36574,36575,36577,36583,36584,36589,36590,36592,36596,36598,36599,36600,36614,36627,36628,36630,36633,36650,36651,36653,36667,36668,36669,36672,36674,36675,36677,36678,36679,36681,36683,36684,36686,36689,36690,36691,36692,36694,36696,36697,36698,36699,36700,36702,36703,36707,36709,36710,36712,36715,36716,36717,36718,36720,36722,36723,36724,36725,36726,36727,36728,36729,36730,36732,36734,36736,36737,36740,36742,36746,36749,36751,36752,36756,36760,36761,36762,36763,36764,36765,36766,36767,36792,36794,36810,36811,36833,36834,36839,36843,36845,36855,36856,36860,36861,36862 } ;
	static const int C1_ind[] = { 96,100,101,106,108,111,123,125,126,127,129,131,132,133,135,136,137,144,145,149,151,154,155,156,158,159,160,163,164,165,168,179,180,181,186,191,261,265,268,288,289,292,293,296,302,304,310,311,315,317,318,319,321,323,336,346,350,360,362,372,378,379,383,484,510,513,570,611,613,614,645,646,649,650,652,653,667,669,672,673,676,677,680,684,686,688,694,695,696,699,701,702,703,705,713,720,721,744,746,747,757,762,763,764,767,837,839,841,844,864,865,866,867,868,869,872,875,878,880,886,887,891,892,893,894,895,897,900,910,912,923,924,932,936,938,943,944,954,955,959,1059,1084,1102,1135,1253,1279,1296,1320,1379,1380,1381,1382,1413,1414,1415,1416,1417,1418,1420,1421,1425,1435,1437,1440,1441,1442,1443,1444,1445,1448,1450,1451,1454,1456,1462,1463,1464,1467,1468,1469,1470,1471,1473,1477,1486,1488,1509,1512,1514,1515,1519,1520,1521,1523,1530,1531,1532,1535,1605,1609,1611,1612,1632,1633,1636,1637,1638,1639,1640,1646,1648,1654,1655,1659,1661,1662,1663,1664,1665,1666,1671,1680,1683,1684,1688,1695,1696,1699,1704,1706,1722,1723,1727,1830,1856,1858,1880,1955,1957,1958,1959,1989,1990,1993,1994,1995,1996,1997,2003,2005,2011,2013,2016,2017,2020,2021,2022,2023,2024,2030,2031,2032,2038,2039,2040,2043,2045,2046,2047,2048,2049,2050,2056,2064,2067,2068,2069,2070,2071,2072,2088,2090,2091,2106,2107,2108,2111,2181,2185,2188,2190,2194,2198,2208,2209,2212,2213,2216,2217,2218,2220,2221,2222,2223,2224,2225,2228,2230,2231,2235,2237,2238,2239,2241,2243,2244,2245,2246,2247,2248,2249,2252,2256,2257,2261,2263,2266,2267,2268,2269,2270,2271,2272,2275,2276,2277,2278,2280,2281,2282,2284,2286,2291,2292,2293,2294,2297,2298,2299,2303,2339,2341,2342,2349,2350,2352,2373,2374,2377,2378,2380,2381,2382,2383,2384,2386,2388,2390,2393,2395,2396,2397,2400,2401,2404,2405,2408,2409,2410,2412,2413,2414,2415,2416,2417,2420,2421,2422,2423,2424,2427,2429,2430,2431,2433,2437,2438,2440,2441,2442,2445,2447,2448,2449,2450,2453,2455,2461,2465,2469,2471,2472,2474,2475,2478,2483,2485,2486,2487,2489,2490,2491,2492,2495,2505,2507,2508,2514,2515,2518,2531,2533,2534,2536,2539,2540,2541,2542,2544,2546,2547,2548,2549,2551,2552,2553,2565,2566,2569,2570,2572,2573,2574,2575,2576,2578,2580,2582,2583,2585,2587,2588,2589,2590,2591,2593,2600,2601,2605,2606,2608,2609,2610,2611,2612,2614,2615,2616,2617,2630,2634,2635,2653,2657,2658,2663,2666,2667,2669,2670,2678,2679,2680,2681,2683,2684,2685 };

	MatrixXd C0 = MatrixXd::Zero(192,192);
	MatrixXd C1 = MatrixXd::Zero(192,14);
	for (int i = 0; i < 4140; i++) { C0(C0_ind[i]) = coeffs(coeffs0_ind[i]); }
	for (int i = 0; i < 497; i++) { C1(C1_ind[i]) = coeffs(coeffs1_ind[i]); } 

	MatrixXd C12 = C0.partialPivLu().solve(C1);


	// Setup action matrix
	Matrix<double,22, 14> RR;
	RR << -C12.bottomRows(8), Matrix<double,14,14>::Identity(14, 14);

	static const int AM_ind[] = { 19,11,0,1,15,2,3,4,18,5,6,20,21,7 };
	// Matrix<double, 14, 14> AM;
    MatrixXd AM(14, 14);
	for (int i = 0; i < 14; i++) {
		AM.row(i) = RR.row(AM_ind[i]);
	}

	Matrix<std::complex<double>, 4, 14> sols;
	sols.setZero();

	// Solve eigenvalue problem
	EigenSolver<Matrix<double, 14, 14> > es(AM);
	ArrayXcd D = es.eigenvalues();	
	ArrayXXcd V = es.eigenvectors();

V = (V / V.row(0).array().replicate(14, 1)).eval();


    sols.row(0) = V.row(1).array();
    sols.row(1) = V.row(4).array();
    sols.row(2) = V.row(8).array();
    sols.row(3) = D.transpose().array();









	return sols;
}
// Action =  w
// Quotient ring basis (V) = x^-1*y^-1*z^-1*w^-1,y^-1*z^-1*w^-1,y^-1*w^-1,y^-1*z^-1,x^-1*z^-1*w^-1,x^-1*y*z^-1*w^-1,x^-1*w^-1,x^-1*z^-1,x^-1*y^-1*w^-1,x^-1*y^-1*z*w^-1,x^-1*y^-1,x^-1*y^-1*z^-1,x^-1*y^-1*z^-1*w,x^-1*y^-1*z^-1*w^2,
// Available monomials (RR*V) = y^-1,y^-1*z^-1*w,x^-1*y*z^-1,x^-1,x^-1*z^-1*w,x^-1*y^-1*z,x^-1*y^-1*w,x^-1*y^-1*z^-1*w^3,x^-1*y^-1*z^-1*w^-1,y^-1*z^-1*w^-1,y^-1*w^-1,y^-1*z^-1,x^-1*z^-1*w^-1,x^-1*y*z^-1*w^-1,x^-1*w^-1,x^-1*z^-1,x^-1*y^-1*w^-1,x^-1*y^-1*z*w^-1,x^-1*y^-1,x^-1*y^-1*z^-1,x^-1*y^-1*z^-1*w,x^-1*y^-1*z^-1*w^2,





void mexFunction(int nlhs, mxArray *plhs[], int nrhs, const mxArray *prhs[])
{
	if (nrhs != 1) {
		mexErrMsgIdAndTxt("automatic_generator_cvpr:toa_34_mirror_r_dist:nrhs", "One input required.");
	}
	if (nlhs != 1) {
		mexErrMsgIdAndTxt("automatic_generator_cvpr:toa_34_mirror_r_dist:nlhs", "One output required.");
	}    
	if (!mxIsDouble(prhs[0]) || mxIsComplex(prhs[0])) {
		mexErrMsgIdAndTxt("automatic_generator_cvpr:toa_34_mirror_r_dist:notDouble", "Input data must be type double.");
	}
	if(mxGetNumberOfElements(prhs[0]) % 19 != 0) {
		mexErrMsgIdAndTxt("automatic_generator_cvpr:toa_34_mirror_r_dist:incorrectSize", "Input size must be multiple of 19.");
	}
	int n_instances = mxGetNumberOfElements(prhs[0]) / 19;
	double *input = mxGetPr(prhs[0]);
	plhs[0] = mxCreateDoubleMatrix(4,14*n_instances,mxCOMPLEX);
	double* zr = mxGetPr(plhs[0]);
	double* zi = mxGetPi(plhs[0]);
	for(int k = 0; k < n_instances; k++) {
		const VectorXd data = Map<const VectorXd>(input + k*19, 19);
		MatrixXcd sols = solver_toa_34_mirror_r_dist(data);
		Index offset = k*sols.size();
		for (Index i = 0; i < sols.size(); i++) {
			zr[i+offset] = sols(i).real();
			zi[i+offset] = sols(i).imag();
		}
	}
}


